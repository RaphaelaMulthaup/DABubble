<div class="message-card w-full" [ngClass]="{ 'message-current-user': senderIsCurrentUser$ | async }">
  <div>
    @if(senderPhotoUrl$ | async; as photoUrl) {
    <img class="profil-img" [src]="senderPhotoUrl$ | async" alt="Profilbild" (click)="displayProfileViewOtherUser()" />
    } @else {
    <img class="profil-img" src="/assets/img/no-avatar.svg" alt="Profilbild" (click)="displayProfileViewOtherUser()">
    }
  </div>
  <div class="message-content">
    <div class="infos-message">
      <h4>{{ senderName$ | async }}</h4>
      <span class="message-time">{{ createdAtTime$ | async }} Uhr</span>
    </div>
    <div class="text">{{ message.text }}</div>

    @if (answers.length > 0) {
    <div class="answers flex flex-col items-start">
      <button class="link w-full" (click)="openAnswers(message.id!)">
        {{answers.length}} {{answers.length > 1? 'Antworten': 'Antwort'}}
      </button>
      <span class="message-time w-full">Letzte Antwort 00:00 Uhr</span>
    </div>
    }

    <div class="interactions flex flex-row">
      @for (reaction of reactions; track $index) {
      @if(reaction.users.length > 0) {
      <div (click)="toggleExistingReaction(reaction.emoji)" class="reaction flex place-items-center">
        <img class="reaction-img" [src]="reaction.emoji" />
        <p>{{ reaction.users.length }}</p>
      </div>
      }
      }

      <div class="relative">
        <button #addReactionBtn (click)="openEmojiPickerOverlay($event)" class="add-reaction btn-tertiary"
          (mouseenter)="addReactionsImg.src = './assets/img/add-reaction-hover.svg'"
          (mouseleave)="addReactionsImg.src = './assets/img/add-reaction.svg'">
          <img #addReactionsImg src="./assets/img/add-reaction.svg" alt="add reaction" />
        </button>
        <!-- <app-emoji-picker [messageFromCurrentUser]="isMessageFromCurrentUser"/> -->
      </div>

    </div>
  </div>
</div>

<!-- btn to add an answer -->
<!-- <button class="btn-tertiary" (mouseenter)="addAnswerImg.src = './assets/img/add-answer-hover.svg'"
  (mouseleave)="addAnswerImg.src = './assets/img/add-answer.svg'">
  <img #addAnswerImg src="./assets/img/add-answer.svg" alt="add answer">
</button> -->